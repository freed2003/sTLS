class TLS13ServerHelloParser:
    def __init__(self, data):
        self.data = data
        self.pointer = 0

    def read_bytes(self, length):
        result = self.data[self.pointer:self.pointer + length]
        self.pointer += length
        return result

    
    def parse(self):
        server_hello = {}
        server_hello['type'] = self.read_bytes(1).hex()
        server_hello['legacy_version'] = self.read_bytes(2).hex()
        server_hello['length'] = self.read_bytes(2).hex()
        server_hello['handshake_header'] = self.read_bytes(4).hex()
        server_hello['server_version'] = self.read_bytes(2).hex()
        server_hello['random'] = self.read_bytes(32).hex()
        server_hello['legacy_session_id_echo_length'] = int.from_bytes(self.read_bytes(1), 'big')
        server_hello['legacy_session_id_echo'] = self.read_bytes(server_hello['legacy_session_id_echo_length']).hex()
        server_hello['cipher_suite'] = self.read_bytes(2).hex()
        server_hello['legacy_compression_method'] = self.read_bytes(1).hex()
        
        extensions_length = int.from_bytes(self.read_bytes(2), 'big')
        server_hello['extensions'] = self.parse_extensions(extensions_length)
        
        return server_hello

    def parse_extensions(self, length):
        extensions = []
        end = self.pointer + length
        while self.pointer < end:
            extension = {}
            extension['type'] = self.read_bytes(2).hex()
            extension_length = int.from_bytes(self.read_bytes(2), 'big')
            extension['data'] = self.read_bytes(extension_length).hex()
            extensions.append(extension)
        return extensions

# Example usage:
# Assuming `data` is the byte stream of the ServerHello message
# data = b'...' 
# parser = TLS13ServerHelloParser(data)
# server_hello_message = parser.parse()
# print(server_hello_message)


# Example usage:
# Assuming `data` is the byte stream of the ServerHello message
# data = b'...' 
data = "160303007a02000076030321e08cfa868e2a9e0f622594c8672e082a015c05539cc999d1178ef714d568fe202e88ea81d028e4b9d963328f60bbcdb3ee6dfe51bae107263d9a49ccc4c0c20d130100002e002b0002030400330024001d0020dbf2666fcd13958b389a0d649b3e7d73bb0cf8ba1084066b4a31edadbc3d8824140303000101170303001b996aeb046e563de02649ce5bc96564f8336ae0853b5a548086aae117030313dbec9b71e26823db88e32bf76a9a533836eb23ef9f7b0595c5496d0e722a327e12dc060e6771f58e4b9dcc6087e901689ef7bef2ab6f7c348e1078b98f532318e3d128af8057ddb855127a04090ccb79544310522ef93c1931531cf3d09a8ed2e435b306dcdf933d081357e657afd11a9c2e498617310048baf824b3a0d0906d4dd2a6c9204393aa029c45916db8bd317c0d711fae396fdc5e1b012fca5a2ab9f55175bec874866b49a4d60bf7e6f83d727d288b4eed9c869669d50617437d7fe00e9f2deec0a1b969878ebab756b1943fc0310775169ca5b2d725864c808a85ff422dfef057b0a16982b32ca98b0aee0eae713145ba311e3ba9748906596c0f829fe15845f22c4c629e5d36fc0737e4b2f5f8e6422063c471d2fc880c258cd91d062d5a5aa5df80177cdfcf3a2548870936b2c2c837f4d4cd3f2551d8b54fe2cadc88e08a11671f191f1d0d2c35cd888c1cb5adf08bada4a63bff880094527d9563337bc452217857c556471d13234df8e27d92febdc06b38906d6113d90abda86d577a341c1f9194a3b5a54f0da6d491de93308773d55f751a43f569d42b2a29b93c357da1a8843443acd5faf264f1018d398e04a9dcc32505fcd533f806b9df5020b62ddb52e2f92d22d2110a39319d1021229b833951856b4c4db54e0e8e5401ba2d5d05afd53d3b6023860ce416f1a39aa96b0406731ab7959a5418cf672f1f10792ec379768a917009224ba6fbd145cfe9141962f636dc2f00c58a307e411d8f77be8cd2b784258fb79f406c4378c17e95e8cf7c37339c35febe53c0d50e43683f4a9eb99b646863a94042108c736e05fbfa10ffc13679a883667eb5e9a3fe9897a4cacd9c88c4ec6a238a208c249d9afbb64a4b41f2f0cc4580991c455e6a97df4a709fc0dfac8fd0c2093c01e331a7717c4f93047310cb3b6ff3f09d60e33e7c11db52b2786d99c936edabdd5d107dedd2b4240ae0950a2b32ff73bb61d216248b052e73e205b36579823125a10f89b41c65a858d34d2dcb2284d0fc38932b33a5bf482fa575a811eed13422bd8a27ee28dad91d6b7d426160a331c67d8896a372141643e205ddc8ead4ea671f5b592416d606e40116a45ca52739cf0702b1c715f926ce77f1123933e11f992279b5cf0ae4d5485fe0aaa7ca2b8d0ed58729a551d2e4f9e7cc0130f63fd5a9b27bb4b1a30e020e0baba1d39d2ed28793a79a8683368ad3e90405d0c74e365ff640448ebfe599d9a25f3554f9b1da2acc813e1a27b21a49fc26c0ba9390a995280de57d2f4d8192e86940195feba5a9a3dd0b481d2def1b381116fb6c6e73c14707458f90629b567bbd992f7952ea7eef46a6c7fd597c3209f2dc8cffd182aaf61392de16c516eb467b59440e017ad018dfe8380bfee401640c39299d1c147f8b2f1988222360c77172e1f2d064c06fbf5fe56ddad77c1ec34fd2cfdc47606024fee5b571611d84230d2973341d514f7d74ba401d2d6ad5833f78b9efe0c19f41932c51fb267dd2a0ea438c64dbbaa46a337ff85d101b34f4bc4f7c72d502d1e094d32adcdef72ec165876502edd1471c414e5d9949661367f6596ccae22c0e0a9a0c841f95f813d4f0b728b79d4c3cf048f9ef1a7f596b61ab6a391fc928b03cb7677fb28c563e5cffcc26b92f648b59c1ea50ac09be8768b98b76917acc292c8bb1b7b184565f4ab1474d0e7788d858fc126b968b778d1f8af061960617ca76726f9ea8776bfbb4c9c0edc7d472de4a94228183eff49fa5ae18b14d7bff09953602170d7c2335602325087728e69389e235aff273fc5f725e8541c3ab697d82f87f81774affef81d14aec64fabfe639d433c19fd0a099f0717988cddc755d435fc2b5a06e89f948ef5b04d1f3bd3012601e9509a2a7710651431d5f6876734dd81f5baba66fe0982e1cedb1cf6a2bd1d2e235782f37d4e0a6e0af8d46947fe2a817005871aa1c05f5ad3564d4257b9d214c724a6444fa4855ed3f0642f018d99f6b0922a479556bb817a5da3e892a7c06eda1c4b1cc2339a861695901ad63d7e786b5a52a602bb4258d5efc95bf7eda9fc6c379ca99b2d8fd0eaceac036aeb7247cefaca48fd6588b6d76899772d72c30179808b4b5add5c0262696236369dcac9457fa823a9adf5678351d742db0c132ae414c4d6a9a44dbf70dbb4a3c88e6eec7a17139bfba28c8738b220214265395f056e7e24059a0ec175b7df91030a3e66261bcab84335d946b94d943db42ac40a0df897f33076878b64958cee7c2b1862bec0ac26224e5fb3c9ffff93ec351b0c041c7979d77fe8b1a5fd928cd94826c20a0909491c7454c0cf0e221b194566c60b24e414dee5a65fd983a7dfcad837215aced541bcdeb05688f47d61bd95189d47f178415690502d06c66b1a49a954743d50832c10602e0de301a48be1756db2b0d6b1ff3361c92135f42fa2a6c50359a50829f62418f4f704eef4debbe2f66acac7da39dd5b085cc26d2b4f0eb05d332fce9c4d2ae638d4f2db6d014eaeb671c1e120d4c57766acee878f05620bb817a082839773c9cd7badab3ee6fc4400a09393f1d9e4d7a0aecd3e5aacedaacdca2ff68a43efb946a1ba1568bd7f856121c744c69f8a73cf98811fd7faf54d32ad3b0fce3145cb2813dfc4b0d6d3209ab3f7a59c1837fec0f84a479507e6618a125d01564c1e6d860cfb8c7f0c1a9d3efcbad20e6be40f57b564f4b31337fd46bfd8c130819714c23a14f8e54c432669552b38fc61cf2b330d19eb3a06870cd0da276face3d3b5e8e97095b08093c947f1fc82137727479b68bf4afd984f89d85df87d24ee92ab9c387a1444a972f7d77f1183c5713b9b57fb4082b5aa785373de73e514456628b9523a97867e0194a56d6dd9413c052c664827d2b04996c0895d196331679b68a162a9f1d5a3bdd9f6b98c9c20d9125c78c6f1a06431d2a8f67c84d72c60e8ac20740b8302daa99f029c10c1c7ec3080a1c3180b01261cf32f2e3b04e4c272297524232f0fbb978c991beffe3ed6adbd44990fe1a5efb0b59add28eb0fcf9a56c07f81a7176efbe52f980ab59b0556620a4791496801829055ad526121418bcb1cf6c74022606d4a4ef297797e9bf24d8ee9879c051914e383b95236e6d7ec931d7249229883783497f1a0f601096bdfac3cb05e06388975afdc345bebec03c606de5e353d424070769aa1ac316dd7de8d2c4344a18fbb325fb1c8eb5ae863b80147499b55bc749ff56b91c73634c873b54f1ab502ad0b692110e4942f15fb979a0036a9e547509c38e8682d4e132c99f406e1bd9d7db5ec3255684e5b62b12642a5209ad28632bf85d9ec4f235a0307d68d657cfb7bffd795b078b5e870164af05b23eadc051e9c31b7bdad8649d21281bd1488a4684f28ad68c56feafd79690fbc7d06347f06c8c4667cbf414cf1682cd4e3cfcf3718b822a1966fe489b1156a01e6495f19ff3b0c38a54225583e3079f09c0da03bd358cfda83d6b570c3739731350bd222900d0948ba8b550f7046e1cb1d908b72267132a178a8158a311a5464777d1f228741cd7a2c9695bfb4252dbb823b68c19a28024777eb158215564721eb1bb6c5f2ab1821283791818414a279b6890d07da2666228fd0f7cdc64c16dd6ae0212b5585235c50bc362afdd7d7ba3411cb5d67d4e87b065bd4b06fc9f15c332e01f957f5eb1fc567076c16db373d3db7cc785f7789778fadff13521f24d3ff8bf6f7defedf31141f8aa103afaf8df599eb0dffba480d1fcb715aa983250e98f9c17bf55c4ba2750b5b857e3501bfec6211c97d4107a1ac75e5b842b574f1045935ff714e5fb5b6cb227e4a8edb86730c586b2133679f1cb60004df4fa89affeedea02d894e9a9552074d94912d1afbb78423c92f2bd4d0eecc39f39324e85a215f70762c54f74f9a7807b8788773868914d2e2d28280ffe432a37d5c3a94b6d3942355c573cd0f994f72fc0d35a3c7e0677d6271d25afafc898e5f41618446949438d1aca17650ac5e4ab8dcf34a4cc30341828463f311a3c5622300ed414380630e1b53a65022ee0aeef0fdf7bef7243295ffdc4e9d7c45857db0b373cf1273e97d0b569d4466aff187bac2489bcc3d01ac71f26eca63d1ee1e86173993b98e7aba860b30c893c5fe114211bf176ab4b777c30b6288db6d745cfc636acb5ef5971ae7a17bc100436e832752202638ca4873e41ec677ab6f039d9d781cce5241fc3844dceffdb68a4ec5c923af6ca6b8905c64f4715fd17b50643fdb1621dfc525eec707f66d6410d093e35813f3f198b775c215ace370cce80c8b2ac50c991bd6289565f107a2883f37669981bb9945debe1a18210bedb41dbee80278be030c24e150fe0b4cf5559010bfe2d842f4f7f9709cbf3661bcca9d8542149eb3481d63866d39c2954245218535db8ddcdeb815baf9bf23831261fcb2a4711930474d5b982940d221c53708e8234bdac9b733df9f5f487c6c30396aa4b8f9aa904f9655ae9e3eb265ef9a6e1b44d6f0d354424f0628fce8d053231c75aa32380664a0853397cc6b60e6604b081426b2985111a635197c6df3b2e36488f6cc28e8c3a4ff7e5a4762b495622e3aedf079710e39360c78f16c0990d3f4895e75b5ea5a1c4415aee8709382c3fb2dfb2e73d41653d861cf771bbe0533994d80bc29c4ea34183af60eb7fc3a709eb9ad79c91fec613a53e8901fd5094aadd638857eee6f1d02de83b86ebde7876ab5839c971073ccbd426c057de3f6e22d7adcf962c45ea457e499b500dad3b861e8772174094b06b967615b767407fd03d39aa55ab0fd1bfba9c3f0b2be7eaac822ac75237667914a5b33ca091ee5c39e33a94c898b136841320f9b6723877b0a48f969191745db8a68be491b35ff3f40d9c6f2c2cc89537a3dc51c7fa2e8f66a83e64ae7441e50d07a73d75445722a2bb3c64b9a2a66bd4bc793426f9427059b0141d93711419066c8ac1f083d47633b67151a4c02a1cac344d3d39cee52ed96f36d145f3ba4ff2a185694867306519f856ce88755b251974ca75db28bda73792b1f0af30ea09488f725a685c85f6dcfd2a9bf92f9ae66118a330291c5fa7197712a2c5b0b8cfa795af6445315e18bcf6b43213a7a6c52c279b1b77dde78541cb40b5e917791ce50d7d1f41a6876e6a52900c51dd5a121a2f5d2c8fd954909f3db6433bf8a4f7e51468e2414ea6082c06e50a04aae12381dcc05f918696d682a6474fc6d77904b6f77b1180c7420a19f4e217dcb8656870517088af8372806badc4ed8872f231ee32a3eaab2d94063b6ba0c6ba745c79f02f87bd1359f5ad0c9089445e931dd408fdf77456411fcc98f9f31f3e6d4ad7541398b8129204886086f64c4682599a191a34f36e6ffc4919f528714678b8562f8ec5cf821bffb55a4784893ae7ce10c18973567930f6a4196acce98190cf18f54b6fd7fd3bacc3622a4e2bcc5056b5ea0bec74c001f0663bbdd7a8e24391d792da2350a810cefa28a726e913511a89074b30308cbeff698abba1"
data = bytes.fromhex(data)
parser = TLS13ServerHelloParser(data)
server_hello_message = parser.parse()
print(server_hello_message)
